---
title: 小米手環門禁卡模擬、今天發現超好用的VSCode Markdown插件
date: 2021-01-19 18:35:46
tags: 
    - Hexo
    - VS Code
categories: 筆記
---
PN532讀卡器+小米手環NFC破解加密門禁實現模擬；VSCode Mardown輔助插件。
<!-- more -->
## 小米手環 - 門卡模擬

&emsp;自從阿爺阿麻(爺爺奶奶)換了新手機之後，由於不是 [OLED](https://baike.baidu.com/item/OLED/1328114?fr=aladdin) 屏幕，不能做到息屏顯示時間(阿爺上一部三星手機一直有的功能，他很喜歡)。
&emsp;所以20年某一次回鄉的時候就買了兩副 _小米手環5 NFC版_ 給兩位老人家。
&emsp;這樣一來有了手環的便攜看時間和NFC功能，除了能滿足阿爺看時間的需求，還能順便給他們做個模擬門禁卡，而且續航很猛，不用再帶門禁卡出入小區了，nice！
&emsp;構思很爽，但沒想到我住處的地方卡是有加密的(淦)，阿爺阿麻另一個住處的門禁可以用，那就只好爽一半了，他們也挺開心的，拿到新玩意。
<br/>

為了將搞機進行到底，有困難那就征服它！

### 準備工作&過程

* 小米手環 NFC版 (廢話(理論應該是任何版本吧)
* PN532讀卡器
* 空白UID卡
* MifareOne Tool

其實性質還是搬運，因為看的又是別人的教程哈哈：
[PN532讀卡器在小米手環5上添加加密門禁卡](https://post.m.smzdm.com/p/awx00qvk/) 

不過這裡說幾個照著以上教程實操後仍需要注意的問題，避免踩坑~
***

#### 實測

1. 按照教程內購買的PN532套餐贈送的**空白卡和藍色圓卡**，在實測中藍色圓卡在 `MifareOne Tool` 軟件的 **`高級操作模式/UID写号`** 操作中會更順利，而白卡在該操作中出現了 **`可能失敗或無響應的提示`** ，所以大家可以直接使用圓卡進行扇區0的信息寫入。
   * 原理好像是空白卡和圓卡的類型是不同的，一個是UID一個是...我沒有深究，或許是一個方向，各位可以往下想想。
2. 把頭8位的16進制數字寫入空白卡之後，**手環端**進行的操作是直接 **`模擬門卡`** 而不是 `模擬空白卡` ，原因在下一個分割線說明。

***

#### 原理

&emsp;原理方面上面link的教程其實有提到，但也到實測的最後才明白他的意思。下面說說我自己的見解：

1. 讀卡器讀取 `需破解門禁卡` (以下簡稱原門禁)的數據，並把破譯的數據存放在一個 `.dump` 文件中。其中包含n個扇區的資料(也就是原門禁內的身份id)。
2. 通過hex編輯器記錄前8個bit的16進制(HEX)數據(相當於一個區塊)。
3. 把 `2.` 中的數據存入空白卡
   * 手環端模擬完 空白卡 再進行 `UID写号` 操作不能一次寫入 `64` 個區塊
   * 於是用 `空白卡` 模擬出的數據直接刷入手環，再進行 `UID写号` 操作
4. 手環端選擇 `門禁模擬/模擬非加密門禁卡` 而非 `模擬空白卡`
   * 此時實際寫入的是最終模擬卡 **1/64** 的區塊
5. 最後用 `UID写号` 把 `1.` 提取的 `.dump` 文件(剩下 63/64 的數據區塊)寫入 `4.` 中的模擬卡，成功！

## VSCode 中的 Markdown 插件

在 VSCode的 `Extensions` (側邊豎欄)中直接搜索 `Markdown` 即可看到若干插件。
其中最值得用的：

* Markdown All in
  * 這個插件好像什麼功能都有了，甚至包括preview預覽功能？
  * 甚至還有許多語法的快捷鍵？
* Markdown Preview Enhanced
  * 這個是專用的在VSCode中打Markdown，旁邊顯示預覽的插件
  * 快捷鍵是 `Ctrl+K, 再按V`
* markdownlint
  * 好像是用於檢測 Markdown 語法
  * 還有糾錯功能(但是給多我兩條黃色警告線，強迫症的我整個人更不好了)
<br/>

## 結語

&emsp;晚些時候要是有機會再操作一次門禁破解&模擬，就上一些自己的配圖和整理成獨立的一篇blog吧！
&emsp;Markdown插件方面的配圖也是，，，遲啲如果摸索到更多的插件用法再更新本條blog吧哈哈哈。。。😁
